# -*- coding: utf-8 -*-
"""Adult_dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1i_X0R1hglKfyig2e1os7_U9k0PcjtKHC
"""

import pandas as pd

dataset = pd.read_csv('/content/adult.csv', header=None, na_values=' ?')
dataset.shape

dataset.columns=['age', 'workclass','wgt','edu','edu_num','marital_status','occ','relation','race','sex','gain','loss','hpw','country','income']
dataset.head()

from sklearn.impute import SimpleImputer
si=SimpleImputer(strategy='most_frequent')
dataset1=si.fit_transform(dataset)
print(pd.DataFrame(dataset1).isnull().sum())

dataset1=pd.DataFrame(dataset1)
dataset1.columns=['age', 'workclass','wgt','edu','edu_num','marital_status','occ','relation','race','sex','gain','loss','hpw','country','income']
print(dataset1.head())

cols=['workclass','wgt','edu','edu_num','marital_status','occ','relation','race','sex','gain','loss','hpw','country','income']
from sklearn.preprocessing import LabelEncoder
le=LabelEncoder()
for i in cols:
  dataset1[i] = le.fit_transform(dataset1[i])
print(dataset1.head())

dataset1.info()

cols1=['age','wgt','edu_num','gain','loss','hpw']
for i in cols1:
  dataset1[i] =dataset1[i].astype('int64')
  dataset1.info()

dataset1.describe()

from sklearn.preprocessing import StandardScaler
sc=StandardScaler()
dataset_std=sc.fit_transform(dataset1)
dataset_std=pd.DataFrame(dataset_std)
print(dataset_std.describe())

dataset_std.head()

target=dataset_std[14]
input=dataset_std.drop(columns=[14])
input.shape

target.shape

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(input,target,test_size=0.25)
x_train.shape

